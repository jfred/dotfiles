#!/usr/bin/env bash

REMOTE_NAME=$(git branch -vv | grep '^*' | cut -d'[' -f 2 | cut -d']' -f 1 | cut -d':' -f1)
REMOTE=$(echo ${REMOTE_NAME} | cut -d'/' -f1)
REMOTE_BRANCH=$(echo ${REMOTE_NAME} | cut -d'/' -f2-)
REMOTE_URL=$(git config --get remote.${REMOTE}.url)
REMOTE_ID=$(echo ${REMOTE_URL} | cut -d':' -f2 | cut -d'.' -f1)

case $REMOTE_URL in
    *@github.com:*)
        open "https://github.com/${REMOTE_ID}/tree/${REMOTE_BRANCH}" ;;
    *@bitbucket.org:*)
        open "https://bitbucket.org/${REMOTE_ID}/src?at=${REMOTE_BRANCH}" ;;
    *) echo "Unsupported remote: ${REMOTE_URL}" ;;
esac
